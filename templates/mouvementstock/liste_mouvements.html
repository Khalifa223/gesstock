<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Liste des Mouvements de Stock</title>
<style>
body{font-family:Arial;background:#f5f6fa;margin:0;padding:20px;}
.container{max-width:1100px;margin:auto;}
h2{text-align:center;color:#2c3e50;}
.table{
 width:100%;background:white;border-collapse:collapse;
 border-radius:8px;overflow:hidden;margin-top:15px;
}
.table th,.table td{
 padding:10px;border-bottom:1px solid #ddd;text-align:left;
}
.table th{background:#34495e;color:white;}
tr:hover{background:#ecf0f1;}
.badge{
 padding:5px 8px;border-radius:5px;color:white;font-size:12px;
}
.badge-in{background:#27ae60;}
.badge-out{background:#c0392b;}
.btn{
 padding:7px 10px;border-radius:5px;text-decoration:none;color:white;font-size:13px;
}
.btn-edit{background:#f39c12;}
.btn-delete{background:#e74c3c;}
.top-btns{text-align:right;margin-bottom:10px;}
.add-btn{
 background:#8e44ad;color:white;padding:10px 15px;border-radius:5px;text-decoration:none;
}
</style>
</head>
<body>
<div class="container">
  {% if messages %}
   <ul class="messages">
       {% for message in messages %}
           <li class="{{ message.tags }}">{{ message }}</li>
       {% endfor %}
   </ul>
{% endif %}
<h2>Mouvement de Stock</h2>
<div class="search-box">
  <input 
    type="text"
    id="searchStockInput"
    placeholder="üîç Rechercher un mouvement (produit, utilisateur, type...)" >
</div>


<div class="top-btns">
    <a href="{% url 'ajouter_entree' %}" class="add-btn">+ Ajouter Entr√©e</a>
    <a href="{% url 'ajouter_sortie' %}" class="add-btn" style="background:#2980b9">- Ajouter Sortie</a>
</div>

    <div class="search-box">
      <input 
        type="text"
        id="searchInput"
        placeholder="üîç Rechercher un produit..."
      >
    </div>

<table class="table">
<tr>
 <th>Date</th>
 <th>Produit</th>
 <th>Type</th>
 <th>Quantit√©</th>
 <th>Utilisateur</th>
 <th>Source/Destination</th>
 <th>Actions</th>
</tr>

{% for m in mouvements %}
<tr>
 <td>{{ m.date_mouvement|date:"d/m/Y H:i" }}</td>
 <td>{{ m.produit.nom }}</td>
 <td>
   {% if m.type_mouvement == 'ENTREE' %}
     <span class="badge badge-in">Entr√©e</span>
   {% else %}
     <span class="badge badge-out">Sortie</span>
   {% endif %}
 </td>
 <td>{{ m.quantite }}</td>
 <td>{{ m.utilisateur }}</td>
 <td>
    {% if m.type_mouvement == 'ENTREE' %}
        {{ m.fournisseur.nom|default:"-" }}
    {% else %}
        {{ m.client.nom|default:"-" }}
    {% endif %}
 </td>
 <td>
    <a href="{% url 'modifier_mouvement' m.id %}" class="btn btn-edit">Modifier</a>
    <a href="{% url 'supprimer_mouvement' m.id %}" class="btn btn-delete">Supprimer</a>
 </td>
</tr>
{% empty %}
<tr><td colspan="7">Aucun mouvement enregistr√©</td></tr>
{% endfor %}
</table>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {

  const stockInput = document.getElementById('searchStockInput');
  const stockTable = document.getElementById('stockTable');

  if (!stockInput || !stockTable) return;

  const stockRows = stockTable.getElementsByTagName('tr');

  stockInput.addEventListener('keyup', function () {
    const filter = stockInput.value.toLowerCase();

    for (let i = 1; i < stockRows.length; i++) {
      const rowText = stockRows[i].innerText.toLowerCase();
      stockRows[i].style.display = rowText.includes(filter) ? '' : 'none';
    }
  });

});
</script>

</body>
</html>
