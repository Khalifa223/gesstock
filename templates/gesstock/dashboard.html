{% extends 'gesstock/base.html' %}

{% block content %}

<!-- DASHBOARD CONTENT -->
{% comment %} <div class="container"> {% endcomment %}

  <!-- KPI -->
  <div class="kpis">
    {% for label, value in kpis.items %}
    <div class="card">
      <div>
        <div class="muted">{{ label|capfirst }}</div>
        <div>{{ value }}</div>
      </div>
      <div class="kpi-icon kpi-blue">
        <i class="fa fa-chart-bar"></i>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- CHARTS -->
  <div class="charts">
    <div class="chart-card">
      <strong>Évolution entrées / sorties</strong>
      <canvas id="chartInOut"></canvas>
    </div>

    <div class="chart-card">
      <strong>Répartition par catégorie</strong>
      <canvas id="chartCategories"></canvas>
    </div>

    <div class="chart-card">
      <strong>Top 5 produits vendus</strong>
      <canvas id="chartTopProducts"></canvas>
    </div>
  </div>

  <!-- TABLE -->
  <div class="table-wrap">
    <strong>Derniers mouvements</strong>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Type</th>
          <th>Produit</th>
          <th>Qté</th>
          <th>Utilisateur</th>
          <th>Commentaire</th>
        </tr>
      </thead>
      <tbody>
        {% for m in mouvements %}
        <tr>
          <td>{{ m.date }}</td>
          <td>
            <span class="badge {% if m.type == 'in' %}in{% else %}out{% endif %}">
              {{ m.type|yesno:"Entrée,Sortie" }}
            </span>
          </td>
          <td>{{ m.produit }}</td>
          <td>{{ m.quantite }}</td>
          <td>{{ m.utilisateur }}</td>
          <td>{{ m.commentaire }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="muted">Aucun mouvement récent</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

{% comment %} </div> {% endcomment %}

{% endblock %}
